const translations = {
    'zh-CN': {
        home: '首页',
        about: '关于我',
        projects: '项目',
        contact: '联系我',
        friends:"友情链接",
        greeting: '你好，我是',
        aboutTitle: '关于我',
        aboutText1: '我是郝某人BH，一名编程爱好者，性别男。在GitHub上，我参与和维护了多个开源项目。我致力于通过代码让生活更高效和便捷。',
        aboutText2: '我喜欢玩的游戏包括《Minecraft》、《三角洲行动》、《无人深空》等等。我尤其喜欢带有科幻元素的游戏。',
        aboutText3: '目前我正在参与蜂群克隆（SwarmClone）开源项目的开发。这是一个模块化的AI虚拟主播开发框架，旨在为开发者和研究者提供构建智能虚拟主播的全套解决方案。',
        githubTitle: 'GitHub 开发足迹',
        githubStat1: '参与组织',
        githubStat2: '开源项目',
        githubStat3: '常用语言',
        githubStat4: '加入时长（年）',
        projectsTitle: '我参与的项目',
        project1Title: '蜂群克隆（SwarmClone）',
        project1Desc: '一个代码完全开源、可高度定制的AI虚拟主播开发框架，致力于为开发者和研究者提供构建智能虚拟主播的全套解决方案。',
        project2Title: 'DrawStudentID 抽学号小工具',
        project2Desc: '一个使用Godot游戏引擎制作的抽学号小工具，支持自定义学号范围和排除学号，使用简单，特级教师用了都说好。',
        contactTitle: '联系我',
        email: '邮箱',
        location: '地点',
        locationText: '中国',
        codeRepo: '代码仓库',
        quote1: "地球是人类的摇篮，但人类不可能永远生活在摇篮中。",
        source1: "——航天之父 齐奥尔科夫斯基",
        quote2: "毁灭作为赞礼 无上肯定",
        source2: "——《黑暗森林》歌词（动画《我的三体之罗辑传》主题曲）",
        quote3: "我们的目标是星辰大海。",
        source3: "——《群星》游戏开场白",
        quote4: "耕耘星海，问鼎苍穹。",
        source4: "——中国航天2025宣传标语（其一）",
        friend1Desc: "一个正在开发桌面美化软件LightFrame（https://lightframe.vilinko.com/）的工作室！您可以前往bilibili查看最新动态（https://space.bilibili.com/373454723）",
        friend1Tag1: 'LightFrame',
        friend1Tag2: 'C++',
        friend1Tag3: '桌面美化',
        footerText: '感谢访问我的个人网站，期待与您交流合作！',
        allRightsReserved: '保留所有权利',
    },
    'en': {
        home: 'Home',
        about: 'About Me',
        projects: 'Projects',
        contact: 'Contact',
        friends:"Friends",
        greeting: 'Hello, I am',
        aboutTitle: 'About Me',
        aboutText1: 'I am hmr-BH, a programming enthusiast (male). On GitHub, I contribute to and maintain several open-source projects. I strive to make life more efficient and convenient through code.',
        aboutText2: 'Games I enjoy include Minecraft, Delta Force: Hawk Ops, No Man\'s Sky, and others. I particularly love games with sci-fi elements.',
        aboutText3: 'Currently, I\'m contributing to the SwarmClone open-source project. This is a modular development framework for AI virtual streamers, aiming to provide developers and researchers with a complete solution for building intelligent virtual streamers.',
        githubTitle: 'GitHub Development Footprint',
        githubStat1: 'Organizations',
        githubStat2: 'Open-Source Projects',
        githubStat3: 'Languages',
        githubStat4: 'Years on GitHub',
        projectsTitle: 'Projects I Contribute To',
        project1Title: 'SwarmClone',
        project1Desc: 'A fully open-source, highly customizable AI virtual streamer development framework dedicated to providing developers and researchers with a complete solution for building intelligent virtual streamers.',
        project2Title: 'DrawStudentID - Student Picker Tool',
        project2Desc: 'A student ID randomizer tool built with Godot Engine. Supports custom ID ranges and exclusions. Simple to use—even master teachers approve!',
        contactTitle: 'Contact Me',
        email: 'Email',
        location: 'Location',
        locationText: 'China',
        codeRepo: 'Code Repository',
        quote1: "The Earth is the cradle of humanity, but mankind cannot stay in the cradle forever.",
        source1: "— Konstantin Tsiolkovsky, Father of Astronautics",
        quote2: "Annihilation as tribute—the ultimate affirmation",
        source2: "— 'Dark Forest' Lyrics (Theme song of 'My Three-Body: Luoji Chronicle')",
        quote3: "Our destiny lies among the stars.",
        source3: "— Stellaris Game Opening",
        quote4: "Cultivate the starry sea, conquer the firmament.",
        source4: "— China Space 2025 Slogan (One variant)",
        friend1Desc: "A studio currently developing LightFrame desktop customization software! (https://lightframe.vilinko.com/) Follow their Bilibili for updates (https://space.bilibili.com/373454723)",
        friend1Tag1: 'LightFrame',
        friend1Tag2: 'C++',
        friend1Tag3: 'Desktop Customization',        
        footerText: 'Thank you for visiting my personal website. Looking forward to communicating and cooperating with you!',
        allRightsReserved: 'All right reserved',
    },
    'ja': {
        home: 'ホーム',
        about: '私について',
        projects: 'プロジェクト',
        contact: '連絡',
        friends:"友達",
        greeting: 'こんにちは、私は',
        aboutTitle: '私について',
        aboutText1: '私は郝某人BHです。情熱的なフルスタック開発者であり、革新的なデジタルソリューションの作成を愛しています。5年以上の開発経験を持ち、高性能でユーザーフレンドリーなアプリケーションの構築に専念しています。',
        aboutText2: '私の技術スタックはフロントエンド（React、Vue）とバックエンド（Node.js、Python）の開発をカバーし、クラウドアーキテクチャ（AWS、Azure）とDevOpsプロセスにも深く関わっています。技術は人間に奉仕するための道具であり、各プロジェクトはユーザーエクスペリエンスと実際の問題の解決に重点を置くべきだと信じています。',
        aboutText3: 'GitHubでは、複数のオープンソースプロジェクトを積極的にメンテナンスし、コードを通じて技術革新とコミュニティコラボレーションを推進することに努めています。私の開発哲学は「複雑さよりもシンプルさ、形式よりも機能」です。',
        githubTitle: 'GitHub開発の足跡',
        githubStat1: 'オープンソースプロジェクト',
        githubStat2: 'コードコミット',
        githubStat3: '貢献者',
        githubStat4: 'スター',
        projectsTitle: '注目のプロジェクト',
        project1Title: '量子アルゴリズム可視化',
        quantumTag: '量子コンピューティング',
        project1Desc: '量子アルゴリズムのインタラクティブな可視化プラットフォーム。WebGLを使用してブラウザで量子ゲート操作と量子ビット状態の変化をリアルタイムにレンダリングします。さまざまな一般的な量子アルゴリズムのデモをサポートしています。',
        project2Desc: '研究者向けのニューラルネットワーク可視化ツールで、モデルアーキテクチャからトレーニングプロセスまでの包括的なビューを提供します。カスタム可視化モジュールと実験比較をサポートします。',
        project3Title: 'APIゲートウェイサーバー',
        microservicesTag: 'マイクロサービス',
        highPerformanceTag: '高性能',
        project3Desc: '軽量なAPIゲートウェイサーバーで、ルーティング配信、リクエスト制限、認証などの機能をサポートします。マイクロ秒単位の応答遅延で、単一ノードで数万の同時接続をサポートします。',
        contactTitle: '連絡先',
        email: 'メール',
        linkedin: 'LinkedIn',
        location: '所在地',
        locationText: '中国 · 上海',
        codeRepo: 'コードリポジトリ',
        deepLearningTag: '深層学習',
        quote1: "破壊を礼賛として、至上の肯定",
        source1: "——歌『ダークフォレスト』歌詞",
        quote2: "地球は人類の揺りかごであるが、人類は永遠に揺りかごの中に生きることはできない。",
        source2: "——宇宙飛行の父、ツィオルコフスキー",
        quote3: "我々の目標は星辰大海（星の海）である。",
        source3: "——ゲーム『Stellaris』オープニング",
        quote4: "星海を耕し、天を制する。",
        source4: "——中国航天2025スローガン（その一）",
        footerText: '私の個人サイトにアクセスしてくれてありがとうございます。あなたとの交流と協力を楽しみにしています！',
        allRightsReserved: 'All right reserved',
    },
    'ru': {
        home: 'Главная',
        about: 'Обо мне',
        projects: 'Проекты',
        contact: 'Контакты',
        friends: "Дружественные ссылки",
        greeting: 'Привет, я',
        aboutTitle: 'Обо мне',
        aboutText1: 'Я hmr-BH, энтузиаст программирования (мужчина). На GitHub я участвую в разработке и поддерживаю несколько проектов с открытым исходным кодом. Я стремлюсь делать жизнь эффективнее и удобнее с помощью кода.',
        aboutText2: 'Мне нравятся игры: Minecraft, Delta Force: Hawk Ops, No Man\'s Sky и другие. Особенно люблю игры с элементами научной фантастики.',
        aboutText3: 'Сейчас я участвую в разработке проекта SwarmClone с открытым исходным кодом. Это модульная платформа для создания AI-виртуальных стримеров, предоставляющая разработчикам и исследователям комплексное решение для создания умных виртуальных ведущих.',
        githubTitle: 'GitHub: След в разработке',
        githubStat1: 'Организации',
        githubStat2: 'Проекты с открытым кодом',
        githubStat3: 'Основные языки',
        githubStat4: 'Стаж на GitHub (лет)',
        projectsTitle: 'Мои проекты',
        project1Title: 'SwarmClone (Роевое Клонирование)',
        project1Desc: 'Полностью открытая и высококастомизируемая платформа для разработки AI-виртуальных стримеров. Предоставляет комплексное решение для создания умных виртуальных ведущих.',
        project2Title: 'DrawStudentID - Генератор номеров студентов',
        project2Desc: 'Инструмент для случайного выбора номеров студентов, созданный на движке Godot. Поддерживает настройку диапазонов и исключений. Прост в использовании - одобрено учителями высшей категории!',
        contactTitle: 'Связаться со мной',
        email: 'Email',
        location: 'Местоположение',
        locationText: 'Китай',
        codeRepo: 'Репозиторий кода',
        quote1: "Земля — колыбель человечества, но нельзя вечно оставаться в колыбели.",
        source1: "— К.Э. Циолковский, отец космонавтики",
        quote2: "Разрушение как хвала — высшее утверждение",
        source2: "— Текст песни «Тёмный лес» (OST аниме «Мой трёхтельный: Ло Цзи»)",
        quote3: "Наша цель — звёздные моря.",
        source3: "— Вступление игры Stellaris",
        quote4: "Возделывать звёздные моря, покорять небесный свод.",
        source4: "— Слоган Китайской космической программы 2025 (один из)",
        friend1Desc: "Студия, разрабатывающая ПО для персонализации рабочего стола LightFrame (https://lightframe.vilinko.com/)! Следите за новостями на Bilibili (https://space.bilibili.com/373454723)",
        friend1Tag1: 'LightFrame',
        friend1Tag2: 'C++',
        friend1Tag3: 'Персонализация рабочего стола',
        footerText: 'Спасибо за посещение моего личного сайта и с нетерпением жду общения и сотрудничества с вами!',
        allRightsReserved: 'All right reserved',
    }
};

// 当前语言
let currentLang = 'zh-CN';

// 名言数组
let quotes = [];
let sources = [];
let currentQuote = 0;
let charIndex = 0;
let deleting = false;
let pauseCounter = 0;
const cursor = document.querySelector('.cursor');

// 更新页面文本
function updateText() {
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[currentLang][key]) {
            el.textContent = translations[currentLang][key];
        }
    });
    
    // 更新名言和出处数组
    quotes = [
        translations[currentLang].quote1,
        translations[currentLang].quote2,
        translations[currentLang].quote3,
        translations[currentLang].quote4
    ];
    
    sources = [
        translations[currentLang].source1,
        translations[currentLang].source2,
        translations[currentLang].source3,
        translations[currentLang].source4
    ];
}

// 打字效果函数
function typeEffect() {
    // 确保quotes数组有内容
    if (!quotes.length) {
        setTimeout(typeEffect, 100);
        return;
    }

    const quoteElement = document.getElementById('typedQuote');
    const sourceElement = document.getElementById('quoteSource');
    const currentText = quotes[currentQuote];
    const currentSource = sources[currentQuote];
    sourceElement.textContent = '        ';
    
    if (!currentText) {
        currentQuote = (currentQuote + 1) % quotes.length;
        setTimeout(typeEffect, 100);
        return;
    }
    
    if (!deleting) {
        // 打字状态
        quoteElement.textContent = currentText.substring(0, charIndex);
        charIndex++;
        
        // 当打到80%时显示来源
        if (charIndex > currentText.length * 0.8 && currentSource) {
            sourceElement.textContent = currentSource;
            sourceElement.style.opacity = Math.min(1, (charIndex - currentText.length * 0.8) / (currentText.length * 0.2));
        }
        
        // 判断是否需要暂停
        if (charIndex > currentText.length) {
            pauseCounter++;
            if (pauseCounter > 20) { // 暂停2秒
                deleting = true;
                pauseCounter = 0;
            }
        }
    } else {
        // 删除状态
        quoteElement.textContent = currentText.substring(0, charIndex);
        
        // 当删到20%时开始淡出来源
        if (charIndex < currentText.length * 0.2 && currentSource) {
            sourceElement.style.opacity = Math.max(0, charIndex / (currentText.length * 0.2));
        }
        
        charIndex--;
        
        if (charIndex === 0) {
            deleting = false;
            sourceElement.textContent = '        ';
            sourceElement.style.opacity = 0;
            currentQuote = (currentQuote + 1) % quotes.length;
        }
    }
    
    // 设置光标的显示状态
    cursor.style.opacity = (charIndex % 2 === 0) ? '1' : '0.7';
    
    // 根据状态调整打字速度
    const typingSpeed = deleting ? 50 : 150 - Math.random() * 40;
    setTimeout(typeEffect, typingSpeed);
}

// 页面加载完成后启动
document.addEventListener('DOMContentLoaded', function() {
    // 初始化语言和名言
    updateText();
    
    // 启动打字效果
    typeEffect();
    
    // 平滑滚动到锚点
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            if (targetId === '#') return;
            
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - document.querySelector('nav').offsetHeight,
                    behavior: 'smooth'
                });
                
                // 移动端点击导航链接后关闭菜单
                document.querySelector('.nav-links').classList.remove('active');
            }
        });
    });
    
    document.getElementById('menu-toggle').addEventListener('click', function() {
        const navLinks = document.querySelector('.nav-links');
        navLinks.classList.toggle('active');
        this.classList.toggle('open');
    });
        
    /* =========  语言立方体功能  ========= */
    const languageCube = document.getElementById('languageCube');
    const cube          = document.querySelector('.cube');
    const cubeFaces     = document.querySelectorAll('.cube-face');

    /* 初始角度 */
    let rotationX = -15;
    let rotationY = -45;

    /* 拖动状态 */
    let isDragging   = false;
    let startX, startY;
    let startRotationX, startRotationY;

    /* 移动端点击区分拖动/点击 */
    let touchMoved   = false;
    const TAP_MAX_DIST = 8;           // 像素阈值，小于它算点击

    /* 节流函数：保证 60 fps */
    function throttle(fn, delay = 16) {
        let timer = null;
        return function (...args) {
            if (timer) return;
            timer = setTimeout(() => {
                fn.apply(this, args);
                timer = null;
            }, delay);
        };
    }

    function applyTransform() {
        cube.style.transform = `rotateX(${rotationX}deg) rotateY(${rotationY}deg)`;
    }

    /* ==========  PC 端鼠标事件  ========== */
    languageCube.addEventListener('mousedown', onMouseDown);

    function onMouseDown(e) {
        isDragging = true;
        startX = e.clientX;
        startY = e.clientY;
        startRotationX = rotationX;
        startRotationY = rotationY;

        cube.style.transition = 'none';
        document.documentElement.classList.add('no-select');

        document.addEventListener('mousemove', onMouseMove);
        document.addEventListener('mouseup',   onMouseUp);
    }

    const onMouseMove = throttle(function (e) {
        if (!isDragging) return;
        e.preventDefault();                 // 禁止选区、图片拖拽

        const deltaX = e.clientX - startX;
        const deltaY = e.clientY - startY;

        rotationY = startRotationY + deltaX * 1.2;
        rotationX = startRotationX - deltaY * 1.2;

        applyTransform();
    });

    function onMouseUp() {
        isDragging = false;

        document.documentElement.classList.remove('no-select');
        document.removeEventListener('mousemove', onMouseMove);
        document.removeEventListener('mouseup',   onMouseUp);
        cube.style.transition = '';
    }

    /* ==========  移动端触摸事件  ========== */
    languageCube.addEventListener('touchstart', onTouchStart, { passive: true });

    function onTouchStart(e) {
        if (e.touches.length !== 1) return;

        touchMoved = false;
        const { clientX, clientY } = e.touches[0];
        startX = clientX;
        startY = clientY;
        startRotationX = rotationX;
        startRotationY = rotationY;

        cube.style.transition = 'none';
        document.documentElement.classList.add('no-select');

        languageCube.addEventListener('touchmove',  onTouchMove, { passive: false });
        languageCube.addEventListener('touchend',   onTouchEnd);
        languageCube.addEventListener('touchcancel',onTouchEnd);
    }

    const onTouchMove = throttle(function (e) {
        if (e.touches.length !== 1) return;

        const dx = e.touches[0].clientX - startX;
        const dy = e.touches[0].clientY - startY;

        if (Math.abs(dx) > TAP_MAX_DIST || Math.abs(dy) > TAP_MAX_DIST) {
            touchMoved = true;
            e.preventDefault();             // 真正拖动才拦截默认行为
        }

        rotationY = startRotationY + dx * 1.2;
        rotationX = startRotationX - dy * 1.2;
        applyTransform();
    });

    function onTouchEnd(e) {
        document.documentElement.classList.remove('no-select');
        languageCube.removeEventListener('touchmove',  onTouchMove);
        languageCube.removeEventListener('touchend',   onTouchEnd);
        languageCube.removeEventListener('touchcancel',onTouchEnd);
        cube.style.transition = '';

        if (touchMoved) e.stopPropagation();   // 拖动结束，阻止后续 click
    }

    /* ==========  语言切换功能  ========== */
    cubeFaces.forEach(face => {
        face.addEventListener('click', function () {
            if (!this.dataset.lang) return;

            cubeFaces.forEach(f => f.classList.remove('active'));
            this.classList.add('active');

            currentLang = this.dataset.lang;
            updateText();
        });
    });
    // 注册年份计算
    (function () {
        const anchorYear = 2022;
        const now = new Date();
        const years = now.getFullYear() - anchorYear;
        document.getElementById('regYears').textContent = years;
    })();
});

document.getElementById("currentYear").textContent = new Date().getFullYear();

document.querySelector('.looking-for').addEventListener('click', function (e) {
  e.preventDefault();                       // 阻止默认跳转
  alert("Thank you for your expectation — I will keep working hard!");
});
